var Page={fTable:null,sOldSearch:"",sPlaceHolder:"Searching for something specific?",rIMDB:new RegExp("#tt\\d"),rFilter:[],rPreSelect:[],roLink:-1,Initialize:function(){conditionizr();$(window).bind("hashchange",this.HashChange);$(".dropdown-menu .signin-box #username").tooltip({placement:"right",trigger:"manual",title:"Wrong Username"});$(".dropdown-menu .signin-box #password").tooltip({placement:"right",trigger:"manual",title:"Wrong Password"});$(".dropdown-menu .signin-box #username").bind("focus",function(){$(this).tooltip("hide")});$(".dropdown-menu .signin-box #password").bind("focus",function(){$(this).tooltip("hide")});$(".dropdown-menu .signin-box #signin").bind("click",this.LoginRequest);$("#register-form #signup").bind("click",this.RegisterRequest);$(".dropdown-menu .signin-box").bind("click",function(e){e.stopPropagation()});$(".dropdown-menu .signin-box #register").bind("click",function(){Recaptcha.create(ReCaptchaKey,"register-captcha",{theme:"clean",callback:Recaptcha.focus_response_field});$("#register-form").modal();return false});$("div#table-wrapper table.dataTable tbody tr").live("click",function(e){e.preventDefault();if($(this).find("span").attr("rel")!=undefined){if(window.location.hash==$(this).find("span").attr("rel")){$("#table-wrapper").hide();$("#page-wrapper").hide();$("#result-wrapper").show()}else window.location.hash=$(this).find("span").attr("rel");if($(this).find("span").data("language")){Page.rPreSelect=new Array($(this).find("span").data("language"));if($(this).find("span").data("season"))Page.rPreSelect.push($(this).find("span").data("season"));if($(this).find("span").data("episode"))Page.rPreSelect.push($(this).find("span").data("episode"))}}});$("a.movie_tab").live("click",function(e,t){e.preventDefault();Page.roLink=-1;$("#result-wrapper > .wrapper > .nav-player > h2").hide(650);if(!t){if($(this).parent().hasClass("active"))return;$("div#result-wrapper > .wrapper > ul.nav.nav-tabs li").removeClass("active");$(this).parent().addClass("active");if($(this).data("type")==0)$("#result-wrapper > .wrapper > .nav-player > h3").html("Click <u>here</u> to play");else if($(this).data("type")==1)$("#result-wrapper > .wrapper > .nav-player > h3").html("Click <u>here</u> to download")}if($("#result-wrapper").data("type")==0){var n=$("div#result-wrapper > .wrapper > ul.nav.nav-tabs li.active").data(),r="#959595",i="??";switch(n[0].quality){case 0:r="#D64D5C";i="LOW";break;case 1:r="#E4900A";i="OKAY";break;case 2:r="#50a166";i="GOOD";break}$("div#result-wrapper > .wrapper .quality-box").css("background-color",r).data("content","This streams available quality is <i>"+i+"</i>.").popover("destroy").popover({html:true,title:"Stream Quality",placement:"top",trigger:"hover"})}});$("div#result-wrapper > .wrapper > .nav-player").live("click",function(e){e.preventDefault();var t=$("div#result-wrapper > .wrapper > ul.nav.nav-tabs li.active").data();if(t==null){$("#notification > .modal-body").html('<div class="notification alert alert-warning">Sorry, but there is <b>no</b> link available for this entry.</div>');$("#notification").modal()}else{if(Object.keys(t).length>1){$("#result-wrapper > .wrapper > .nav-player > h2").show(500);var n=Array(Object.keys(t).length).join().split(",").map(function(e,t){return t});n.splice(Page.roLink,1);Page.roLink=n[Math.floor(Math.random()*n.length)]}else Page.roLink=0;window.open(t[Page.roLink].URL,t[Page.roLink].ID)}});$("#movie-slider").touchCarousel({pagingNav:false,snapToItems:false,itemsPerMove:4,scrollToLast:false,loopItems:true,scrollbar:true});$("a.item-block").hover(function(){$(this).find(".info").slideDown("slow")},function(){$(this).find(".info").stop().slideUp("fast")});$("div.search_holder :input").fancyInput();var e=$("div.search_holder input").val("")[0];fancyInput.setCaret(e);$("div.search_holder input").bind("textchange",function(e,t){if(t==""&&$(this).val()!=""){$("div.fancy_placeholder").html("")}else if($(this).val()==""){$("div.fancy_placeholder").html(Page.sPlaceHolder)}Page.SearchRequest()});$("div.search_holder").keypress(function(e){if(e.which==13)Page.SearchRequest()});$("#date-selector > li").bind("click",function(){if($(this).data("date").length){$("#date > b").html($(this).data("date"));Page.rFilter=$(this).data("date");Page.LoadLinkTable("updates")}});$("div.table-filter span.btn").click(function(e){e.preventDefault();Page.rFilter=$(this).html();Page.LoadLinkTable(window.location.hash.substr(1))});this.HashChange();this.InitContactPage();$("div.search_holder.fancyInput").find("b.caret").css("height","39px");$("div.search_holder.fancyInput").find(":input")[0].focus();if(typeof Manage!="undefined")Manage.Initialize()},HashChange:function(e){$("#header .navigation li a.active").removeClass("active");$("#header .navigation li a[href='"+window.location.hash+"']").addClass("active");$("#result-wrapper > .wrapper > .nav-player > h2").hide(650);if(window.location.hash.length){if(Page.rIMDB.test(window.location.hash)){if(window.location.pathname!="/"){window.location.pathname="/"+window.location.hash;return}$("#table-wrapper").fadeOut(100,function(){$("#page-wrapper").hide();$("#result-wrapper").fadeIn(300)});$.ajax({type:"POST",url:window.location.protocol+"//"+window.location.hostname+"/request",data:"mID="+window.location.hash.substr(3)+(Page.rPreSelect.length?"&language="+Page.rPreSelect[0].toLowerCase():""),dataType:"JSON",success:function(e){if(e!=null&&e[0].name){$("#result-wrapper > .header > #seasons").remove();$("#result-wrapper > .header > #episodes").remove();$("#result-wrapper").data("type",e[0].type);$("#result-wrapper > .header > .left").html(e[0].name+" ("+e[0].year+")");$("#result-wrapper > .wrapper > span").html(e[0].plot?e[0].plot:"<i>There's currently no detailed content description available for this entry.</i>");$("#result-wrapper > .wrapper > img").attr("src",e[0].cover);$("#result-wrapper > .wrapper > img").attr("title",e[0].name);$("#result-wrapper > .wrapper #directors").html(e[0].directors[0]?Page.Truncate(e[0].directors[0],20):"Unknown");$("#result-wrapper > .wrapper #duration").html("~ "+(e[0].duration?e[0].duration:"??")+" min.");$("#result-wrapper > .wrapper #genres").html(e[0].genres[0]?e[0].genres[0]:"Unknown");$("#result-wrapper > .wrapper #actors").html(e[0].actors[0]?Page.Truncate(e[0].actors[0],20):"Unknown");$("#result-wrapper > .wrapper #released").html(e[0].released?e[0].released:"Unknown");$("#result-wrapper > .wrapper > div.stars > div > span").css("width",parseFloat(e[0].rating)*10+"%");$("#result-wrapper > .wrapper > div.stars > div").attr("title","IMDB Rating: "+e[0].rating+"/10");$("#result-wrapper > .wrapper i").tooltip();if(e[0].genres.length>1)Page.InjectToolTip("Genres","top",e[0].genres,"#result-wrapper > .wrapper #genres");if(e[0].directors.length>1)Page.InjectToolTip("Directors","top",e[0].directors,"#result-wrapper > .wrapper #directors");if(e[0].actors.length>1)Page.InjectToolTip("Actors","right",e[0].actors,"#result-wrapper > .wrapper #actors");var t=$("#result-wrapper > .header #language-switcher");t.html("");$('<select id="polyglot-language-options"></select>').appendTo(t);t=t.find("select#polyglot-language-options");for(var n=0;n<e[0].languages.length;n++)$('<option id="'+e[0].languages[n].symbol.toLowerCase()+'">'+e[0].languages[n].text+"</option>").appendTo(t);$("#result-wrapper > .header #language-switcher").languageswitcher({effect:"fade",onChange:function(t){$.ajax({type:"POST",url:window.location.protocol+"//"+window.location.hostname+"/request",data:"mID="+window.location.hash.substr(3)+"&language="+t.selectedItem,dataType:"JSON",success:function(e){if($("#result-wrapper").data("type")==2)Page.InjectSeasonSelect(e);$("#result-wrapper > .wrapper > span").html(e[0].plot?e[0].plot:"<i>There's currently no detailed content description available for this entry.</i>")}});if($("#result-wrapper").data("type")!=2){Page.LoadEntryLinks(t.selectedItem);if(t.selectedItem=="de")Page.UpdateTrailer(e[0].trailer_de,e[0].name);else Page.UpdateTrailer(e[0].trailer_en,e[0].name)}}});if(e[0].type==0){$("div#result-wrapper > .wrapper .quality-box").css("background-color","#959595");$("div#result-wrapper > .wrapper table tr:last-child").show()}else $("div#result-wrapper > .wrapper table tr:last-child").hide();if(e[0].hasOwnProperty("seasons"))Page.InjectSeasonSelect(e);else{Page.LoadEntryLinks();if($("#result-wrapper > .header #language-switcher .current").attr("id")=="de")Page.UpdateTrailer(e[0].trailer_de,e[0].name);else Page.UpdateTrailer(e[0].trailer_en,e[0].name)}}else window.location.hash="updates"}})}else{if(window.location.hash.substr(1)!="updates")Page.rFilter=[];Page.LoadLinkTable(window.location.hash.substr(1))}}else if(window.location.pathname=="/")window.location.hash="updates";$('<link rel="shortcut icon" type="image/x-icon" href="'+$('link[rel="shortcut icon"]').remove().attr("href")+'" />').appendTo("head")},LoadLinkTable:function(e){$("#table-wrapper").show();$("#result-wrapper").hide();$("#page-wrapper").hide();if(e=="updates"){$(".table-filter > #alphabet").fadeOut(300,function(){$(".table-filter > #date").fadeIn(100)})}else $(".table-filter > #date").fadeOut(300,function(){$(".table-filter > #alphabet").fadeIn(100)});Page.fTable=$("#linktable").dataTable({bJQueryUI:false,bDestroy:true,bProcessing:false,bServerSide:true,sServerMethod:"POST",sAjaxSource:window.location.protocol+"//"+window.location.hostname+"/request",sPaginationType:"full_numbers",fnServerParams:function(t){t.push({name:"type",value:e});t.push({name:"filter",value:Page.rFilter})},aoColumns:[{bSortable:false,sClass:"center"},{},{bSortable:false,sClass:"center"},{bSortable:false,sClass:"center"},{sClass:"center"}],sDom:"rt<pl>",iDisplayLength:50,oLanguage:{sProcessing:"&nbsp;",sLengthMenu:"_MENU_",oPaginate:{sFirst:"&laquo;",sLast:"&raquo;",sNext:"&rsaquo;",sPrevious:"&lsaquo;"}}})},SearchRequest:function(){if($("div.search_holder input").val().trim()!=Page.sOldSearch||$("div#result-wrapper").is(":visible")){if($("div.search_holder input").val().trim()==Page.sPlaceHolder){Page.HashChange(null)}else if($("div.search_holder input").val().trim().length>=3||$("div.search_holder input").val().trim()==""){if(Page.fTable!=null){Page.fTable.fnFilter($("div.search_holder input").val().trim());$("#table-wrapper").show();$("#result-wrapper").hide();$("#page-wrapper").hide()}else{Page.LoadLinkTable("updates")}}Page.sOldSearch=$("div.search_holder input").val().trim()}},LoginRequest:function(){if($("#username").val().length>=5&&$("#password").val().length>=6){$.ajax({type:"POST",url:window.location.protocol+"//"+window.location.hostname+"/request",dataType:"JSON",data:"aLogin=1&username="+$("#username").val()+"&password="+$("#password").val(),success:function(e){if(e.status==true){window.location.href="./"}else if(e.status==false&&e.code==1){$("#notification > .modal-body").html('<div class="notification alert alert-error">Sorry, but your account is not yet activated or <b>blocked</b>.</div>');$("#notification").modal()}else{$(".dropdown-menu .signin-box #username").tooltip("show");$(".dropdown-menu .signin-box #password").tooltip("show")}},error:function(){$("#notification > .modal-body").html('<div class="notification alert alert-error">We are sorry, but you can\'t log in to your account at the moment.<br />An <b>unknown error</b> occurred. Contact us to report this error.</div>');$("#notification").modal()}})}return false},RegisterRequest:function(){if(!$("#name").val().match(/^[a-zA-Z0-9_]{5,12}$/)){$("#register-form .alert").removeClass("alert-info").addClass("alert-error").html("Special characters are not allowed in username (5-12 chars length).");Recaptcha.reload();return}if(!$("#secret").val().match(/^.{6,20}$/)||$("#secret").val()!=$("#confirm").val()){$("#register-form .alert").removeClass("alert-info").addClass("alert-error").html("Please check your passwords (6-20 chars length).");Recaptcha.reload();return}if(!Recaptcha.get_response().length){$("#register-form .alert").removeClass("alert-info").addClass("alert-error").html("Please fill out the CAPTCHA.");Recaptcha.reload();return}$.ajax({type:"POST",url:window.location.protocol+"//"+window.location.hostname+"/request",dataType:"JSON",data:"aRegister=1&name="+$("#name").val()+"&password="+$("#secret").val()+"&challenge="+Recaptcha.get_challenge()+"&response="+Recaptcha.get_response(),success:function(e){if(!e.status){switch(e.code){case 0:{$("#register-form .alert").removeClass("alert-info").addClass("alert-error").html("Please make sure all required fields are filled out correctly.")}break;case 1:{$("#register-form .alert").removeClass("alert-info").addClass("alert-error").html("You have entered an incorrect CAPTCHA.")}break;case 2:{$("#register-form .alert").removeClass("alert-info").addClass("alert-error").html("This username is already taken.")}break;case 3:{$("#register-form .alert").removeClass("alert-info").addClass("alert-error").html("Unknown error during registration.")}break}Recaptcha.reload()}else{$("#register-form .alert").removeClass("alert-info").removeClass("alert-error").addClass("alert-success").html("Your account has been created successfully.<br />You can sign in now and enjoy all our features to the fullest.");$("#signup").hide();$("#register-form input").attr("readonly",true)}}})},InjectToolTip:function(e,t,n,r){var i="";for(a=1;a<(n.length>20?20:n.length);a++)i+=n[a]+"<br />";$(r).append('<a href="#" onClick="return false;" data-toggle="tooltip" data-content="'+i+'"><i class="icon-chevron-down"></i></a>');$(r+" a").popover({html:true,title:e,placement:t,trigger:"hover"})},InjectSeasonSelect:function(e){$("#result-wrapper > .header > #seasons").remove();$("#result-wrapper > .header > #episodes").remove();if(Object.keys(e[0].seasons).length){$('<select id="seasons"></select>').appendTo($("#result-wrapper > .header"));$('<select id="episodes"></select>').appendTo($("#result-wrapper > .header"));$.each(e[0].seasons,function(e,t){$("<option>Season "+e+"</option>").appendTo($("#result-wrapper > .header > #seasons")).data({season:e,episodes:t})});$("#result-wrapper > .header > #seasons").change(function(){$("#result-wrapper > .header > #episodes").html(null);var e=$(this).find("option:selected");$.each(e.data("episodes"),function(t,n){$("<option>Episode "+n+"</option>").appendTo($("#result-wrapper > .header > #episodes")).data({season:e.data("season"),episode:n})});if(Page.rPreSelect.length==3){$('select#episodes option:contains("Episode '+Page.rPreSelect[2]+'")').attr("selected",true);Page.rPreSelect=[]}$("#result-wrapper > .header > #episodes").change()});$("#result-wrapper > .header > #episodes").change(function(){Page.LoadEntryLinks()});if(Page.rPreSelect.length==3)$('select#seasons option:contains("Season '+Page.rPreSelect[1]+'")').attr("selected",true);$("#result-wrapper > .header > #seasons").change()}},LoadEntryLinks:function(e){var t=false,n="",r=' class="active"',i="",s="";var i=e?e:$("#result-wrapper > .header #language-switcher .current").attr("id");var o=$("#result-wrapper > .header > #episodes").find("option:selected");if(o.length)s="&season="+o.data("season")+"&episode="+o.data("episode");$("#result-wrapper > .wrapper > .nav-player > div").addClass("loader-64");$.ajax({type:"POST",url:window.location.protocol+"//"+window.location.hostname+"/request",data:"mID="+window.location.hash.substr(3)+"&raw=true&language="+i+s,dataType:"JSON",success:function(e){var i=[0,0],s=[[],[]];e=e[1];$("#result-wrapper > .wrapper > ul").html(null);for(var o in e){if(i[e[o]["type"]]++>=6){s[e[o]["type"]]=$.merge(s[e[o]["type"]],e[o]["links"]);continue}if(e[o]["icon"])n=" style=\"background: url('"+e[o]["icon"]+"');\"";else n="";$("<li"+r+'><a href="#" data-type="'+e[o]["type"]+'" class="movie_tab"><i class="icon-hoster"'+n+"></i>"+e[o].name+'&nbsp;<span class="badge badge-info">'+$(e[o]["links"]).size()+"</span></li>").appendTo(e[o].type==0?$("#result-wrapper > .wrapper > ul.nav-top"):$("#result-wrapper > .wrapper > ul.nav-bottom")).data(e[o]["links"]);if(!t){t=true;r=""}}for(var o in s){if($(s[o]).size()){$('<li><a href="#" class="movie_tab"><i class="icon-hoster"></i>Others&nbsp;<span class="badge badge-info">'+$(s[o]).size()+"</span></li>").appendTo(o==0?$("#result-wrapper > .wrapper > ul.nav-top"):$("#result-wrapper > .wrapper > ul.nav-bottom")).data(s[o])}}$("a.movie_tab").trigger("click",true);setTimeout(function(){$("#result-wrapper > .wrapper > .nav-player > div").removeClass("loader-64")},400)}})},UpdateTrailer:function(e,t){$("#result-wrapper > .header > button#trailer").remove();if(e){$('<button id="trailer" class="btn btn-small btn-info">Show Trailer</button>').appendTo($("#result-wrapper > .header")).bind("click",function(){$.fancybox({padding:0,autoScale:false,transitionIn:"none",transitionOut:"none",title:t+"&nbsp;Trailer",width:680,height:410,href:(e+"&hd=1;autoplay=1;autohide=1;showinfo=0;rel=0;iv_load_policy=3;modestbranding=1").replace(new RegExp("watch\\?v=","i"),"v/"),type:"swf"});return false})}},InitStreamPage:function(){$("#entry").change(function(){if($(this).find("option:selected").data("type")==2){$("#series-data").show()}else $("#series-data").hide()});$("#nav-manual").bind("click",function(){$("li.active").removeClass("active");$(this).parent().addClass("active");$("#bulk").hide();$("#new").hide();$("#manual").show();$("#api").hide();return false});$("#nav-bulk").bind("click",function(){$("li.active").removeClass("active");$(this).parent().addClass("active");$("#bulk").show();$("#new").hide();$("#manual").hide();$("#api").hide();return false});$("#nav-new").bind("click",function(){$("#bulk").hide();$("#new").show();$("#manual").hide();$("#api").hide();return false});$("#nav-api").bind("click",function(){$("li.active").removeClass("active");$(this).parent().addClass("active");$("#bulk").hide();$("#new").hide();$("#manual").hide();$("#api").show();return false});$("#check-id").bind("click",function(){if(Page.rIMDB.test("#"+$('input[name="imdb"]').val())){$.ajax({type:"POST",url:window.location.protocol+"//"+window.location.hostname+"/request",data:"aIMDBCheck=1&ID="+$('input[name="imdb"]').val(),dataType:"JSON",success:function(e){if(e.STATUS){$('input[name="imdb"]').css("color","#09BA12");$('input[name="name_de"]').val(e.TITLE.DE);$('input[name="name_en"]').val(e.TITLE.EN)}else $('input[name="imdb"]').css("color","#BA1209")},beforeSend:function(){$("#check-id").attr("disabled",true);$('input[name="imdb"]').attr("disabled",true);$(".loader-20").show()},complete:function(){$("#check-id").attr("disabled",false);$('input[name="imdb"]').attr("disabled",false);$(".loader-20").hide()}})}return false});$("#select-bulk").bind("click",function(){$('input[name="file-bulk"]').click()});$('input[name="file-bulk"]').change(function(){$("input.filename").val($('input[name="file-bulk"]').val())});$("#entry option:first").attr("selected",true);$("#entry").change()},InitContactPage:function(){var e=$("#wizard-message").wizard();e.cards["personal"].on("validate",function(e){if(!e.el.find('input[name="name"]').val().match(/^[a-zA-Z ]{5,30}$/)){e.wizard.errorPopover(e.el.find('input[name="name"]'),"Please type in your full name.");return false}if(e.el.find('input[name="mail"]').val().length){if(!e.el.find('input[name="mail"]').val().match(/^[\w\.=-]+@[\w\.-]+\.[\w]{2,4}$/)){e.wizard.errorPopover(e.el.find('input[name="mail"]'),"Please type in a valid E-Mail.");return false}}return true});e.cards["services"].on("validate",function(e){e.wizard.errorPopover($(".wizard-next"),"&nbsp;");if(e.el.find('textarea[name="message"]').val().length<40){$(".wizard-cards .popover .popover-content").html("Your message is too short.");return false}if(!Recaptcha.get_response().length){$(".wizard-cards .popover .popover-content").html("Please fill out the Captcha.");return false}$(".wizard-cards .popover").remove();return true});e.on("reset",function(){Recaptcha.reload()});e.on("submit",function(e){$.ajax({type:"POST",url:window.location.protocol+"//"+window.location.hostname+"/request",data:"aContact=1&"+e.serialize(),dataType:"JSON",success:function(t){if(t.status){e.submitSuccess();e.hideButtons()}else{e.submitError();e.hideButtons()}},error:function(){e.submitFailure();e.hideButtons()}})});e.el.find(".im-done").bind("click",function(){e.reset().close()});e.el.find(".send-new-mail").bind("click",function(){e.reset()});$("#open-wizard, #error-contact").bind("click",function(t){t.preventDefault();Recaptcha.create(ReCaptchaKey,"contact-captcha",{theme:"clean",callback:Recaptcha.focus_response_field});e.show()})},Truncate:function(e,t){var n="";if(e.Length>t)n=e.substr(0,t)+" [..]";else n=e;return n}}